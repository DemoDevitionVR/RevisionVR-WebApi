<!DOCTYPE html>
<html>
<head>
    <title>Device Position Updates</title>
</head>
<body>
    <div id="positionUpdates"></div>

    <input type="text" id="xInput" placeholder="X Coordinate">
    <input type="text" id="yInput" placeholder="Y Coordinate">
    <input type="text" id="zInput" placeholder="Z Coordinate">
    <button id="sendButton">Send Position</button>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/3.1.12/signalr.min.js"></script>

    <script>
        const connection = new signalR.HubConnectionBuilder()
            .withUrl("/DevicePositionHub") // Adjust the URL to match your SignalR hub endpoint
            .configureLogging(signalR.LogLevel.Information)
            .build();

        connection.start()
            .then(() => {
                console.log("Connected to DevicePositionHub");

                connection.on("OnPositionReceived1", (index, x, y, z) => {
                    // Handle updates for method name "OnPositionReceived1"
                    document.getElementById("positionUpdates").innerHTML +=
                        `Index: ${index}, X: ${x}, Y: ${y}, Z: ${z}<br>`;
                });
            })
            .catch(error => console.error(`Error: ${error}`));

        document.getElementById("sendButton").addEventListener("click", () => {
            const x = parseFloat(document.getElementById("xInput").value);
            const y = parseFloat(document.getElementById("yInput").value);
            const z = parseFloat(document.getElementById("zInput").value);

            if (!isNaN(x) && !isNaN(y) && !isNaN(z)) {
                connection.invoke("BroadcastPosition", x, y, z).catch(error => {
                    console.error(`Error sending position: ${error}`);
                });

                // Clear input fields after sending
                document.getElementById("xInput").value = "";
                document.getElementById("yInput").value = "";
                document.getElementById("zInput").value = "";
            } else {
                console.error("Invalid input. Please enter valid coordinates.");
            }
        });
    </script>
</body>
</html>